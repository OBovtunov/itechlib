pipeline {
          agent any
           options {
		timestamps ()
	    } 
	
	stages{
               stage('Create docker'){
			agent{
			    dockerfile{ filename './node/Dockerfile2'
	                        args '--name node -v exchange:/exchange  '
					  	
				    }
	            }
               stages{
	                		stage('Build'){
						steps{
						                sh '''
								npm install
								npm run build
						                cp -r .next/* /exchange
						                '''
							    	}
	                		}
				    }
		   stage('Start NodeJS'){
                    			steps{
				                     sh '''
		 			              	   docker-compose up -d ''' 
			    	               }
      }
  }
}
		 
		   
